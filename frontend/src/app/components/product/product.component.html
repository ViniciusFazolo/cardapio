<div class="card card-body border border-0 product-bg">
  <a data-bs-toggle="modal" [attr.data-bs-target]="'#' + product.description">
    <div class="row">
      <div class="col-3">
        <img [src]="product.imageUrl" [alt]="product.description" class="img-fluid rounded-2" />
      </div>
      <div class="col-6">
        <h5>{{ product.description }}</h5>
      </div>
      <div class="col-3">
        <span>
          {{product.price | currency : "BRL" : "symbol" : "1.2-2" : "pt-BR"}}
        </span>
      </div>
    </div>
  </a>
</div>

<app-modal [id]="product.description" [btnPrimary]="'Adicionar'" [positionMiddle]="true" [title]="product.description"
  [scrollable]="true" (confirm)="submit()">
  <form [formGroup]="myForm">
    <app-numeric-spinner formControlName="qtItems" [label]="'Quantidade'" [class]="'align-items-center justify-content-between'" [titleStyle]="'title'"/>
    
    @if (product.productOptionTitle.length != 0) {
      <hr class="border border-secondary">
    }
    
    <div formArrayName="productOptions"> 
      @for (productOptionTitle of myForm.value.productOptions; track $index) {
        <div>
          <div class="d-flex justify-content-between align-items-center p-2 rounded-2 title">
            <div class="d-flex flex-column">
              <span class="title">{{productOptionTitle.description}}</span>
              @if(productOptionTitle.qtOptionsSelected){
                <span class="qtSelected">Selecione até {{productOptionTitle.qtOptionsSelected}} {{productOptionTitle.qtOptionsSelected == 1 ? 'opção' : 'opções'}}</span>
              }
            </div>
            
            @if(productOptionTitle.required){
              <span class="required rounded-2">Obrigatório</span>
            }
          </div>
          <div [formGroupName]="$index">
            @for (option of productOptionTitle.options; track $index) {
              <div formArrayName="options">
                <div class="px-4 py-2 d-flex justify-content-between align-items-center" [formGroupName]="$index">
                  <label [for]="option.id">{{option.option}}</label>
                  <input [id]="option.id" formControlName="checked" class="form-check-input border" type="checkbox"> 
                </div>
              </div>
            }
          </div>
        </div>
      }
    </div>

    <hr class="border border-secondary">
   
    <app-product-notes formControlName="notes"/>
  </form>
</app-modal>